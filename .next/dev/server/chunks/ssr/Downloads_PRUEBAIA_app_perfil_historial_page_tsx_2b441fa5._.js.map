{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/yeral/Downloads/PRUEBAIA/app/perfil/historial/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport { Button } from \"@/components/ui/button\"\nimport { Card } from \"@/components/ui/card\"\nimport { ChevronLeft, Package, TrendingUp, Gift, RefreshCw, DollarSign, Truck } from \"lucide-react\"\nimport Link from \"next/link\"\n\ninterface HistorialItem {\n  id: number\n  tipo: string\n  titulo: string\n  fecha: string\n  puntos: number\n  estado: string\n  co2_ahorrado?: number\n}\n\nexport default function HistorialPage() {\n  const [historial, setHistorial] = useState<HistorialItem[]>([])\n  const [totales, setTotales] = useState({ puntos: 0, transacciones: 0 })\n  const [loading, setLoading] = useState(true)\n\n  useEffect(() => {\n    cargarHistorial()\n  }, [])\n\n  const cargarHistorial = async () => {\n    try {\n      // Cargar impacto ambiental como historial\n      const res = await fetch(\"/api/impacto\", { credentials: \"include\" })\n      const data = await res.json()\n\n      if (data.success && data.data.ultimas_acciones) {\n        const items = data.data.ultimas_acciones.map((accion: any) => ({\n          id: accion.id,\n          tipo: accion.tipo_accion,\n          titulo: accion.nombre_item || getNombreAccion(accion.tipo_accion),\n          fecha: new Date(accion.created_at).toLocaleDateString(\"es-CO\"),\n          puntos: getPuntosPorAccion(accion.tipo_accion),\n          estado: \"completado\",\n          co2_ahorrado: accion.co2_ahorrado,\n        }))\n        setHistorial(items)\n        setTotales({\n          puntos: items.reduce((acc: number, item: HistorialItem) => acc + item.puntos, 0),\n          transacciones: items.length,\n        })\n      }\n    } catch (error) {\n      console.error(\"Error cargando historial:\", error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const getNombreAccion = (tipo: string) => {\n    const nombres: Record<string, string> = {\n      donacion: \"Donación realizada\",\n      intercambio: \"Intercambio completado\",\n      venta: \"Venta realizada\",\n      recoleccion: \"Recolección completada\",\n    }\n    return nombres[tipo] || tipo\n  }\n\n  const getPuntosPorAccion = (tipo: string) => {\n    const puntos: Record<string, number> = {\n      donacion: 50,\n      intercambio: 30,\n      venta: 10,\n      recoleccion: 20,\n    }\n    return puntos[tipo] || 0\n  }\n\n  const getIconoAccion = (tipo: string) => {\n    switch (tipo) {\n      case \"donacion\":\n        return <Gift className=\"h-6 w-6 text-pink-400\" />\n      case \"intercambio\":\n        return <RefreshCw className=\"h-6 w-6 text-blue-400\" />\n      case \"venta\":\n        return <DollarSign className=\"h-6 w-6 text-green-400\" />\n      case \"recoleccion\":\n        return <Truck className=\"h-6 w-6 text-orange-400\" />\n      default:\n        return <Package className=\"h-6 w-6 text-accent\" />\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-primary flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-accent\"></div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"min-h-screen bg-primary\">\n      <div className=\"container mx-auto px-4 py-8 max-w-4xl\">\n        {/* Header */}\n        <div className=\"flex items-center gap-4 mb-8\">\n          <Link href=\"/perfil\">\n            <Button\n              variant=\"outline\"\n              className=\"bg-accent text-accent-foreground border-accent hover:bg-accent/90 h-10 px-4 flex items-center gap-2\"\n            >\n              <ChevronLeft className=\"h-5 w-5\" />\n              Regresar\n            </Button>\n          </Link>\n          <h1 className=\"text-2xl font-bold text-white\">Historial de Actividad</h1>\n        </div>\n\n        {/* Resumen */}\n        <div className=\"grid grid-cols-2 gap-4 mb-6\">\n          <Card className=\"bg-secondary border-secondary p-4\">\n            <div className=\"flex items-center gap-3\">\n              <TrendingUp className=\"h-8 w-8 text-accent\" />\n              <div>\n                <p className=\"text-sm text-primary-foreground/70\">Total Ganado</p>\n                <p className=\"text-2xl font-bold text-accent\">+{totales.puntos}</p>\n              </div>\n            </div>\n          </Card>\n\n          <Card className=\"bg-secondary border-secondary p-4\">\n            <div className=\"flex items-center gap-3\">\n              <Package className=\"h-8 w-8 text-accent\" />\n              <div>\n                <p className=\"text-sm text-primary-foreground/70\">Transacciones</p>\n                <p className=\"text-2xl font-bold text-primary-foreground\">{totales.transacciones}</p>\n              </div>\n            </div>\n          </Card>\n        </div>\n\n        {/* Lista de historial */}\n        <div className=\"space-y-4\">\n          {historial.length === 0 ? (\n            <Card className=\"bg-secondary border-secondary p-8 text-center\">\n              <Package className=\"h-12 w-12 text-accent/50 mx-auto mb-4\" />\n              <p className=\"text-primary-foreground/70\">Aún no tienes actividad registrada</p>\n              <Link href=\"/publicar\">\n                <Button className=\"mt-4 bg-accent text-accent-foreground hover:bg-accent/90\">\n                  Publicar mi primer artículo\n                </Button>\n              </Link>\n            </Card>\n          ) : (\n            historial.map((item) => (\n              <Card key={item.id} className=\"bg-secondary border-secondary p-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"bg-primary rounded-full p-3\">{getIconoAccion(item.tipo)}</div>\n                    <div>\n                      <h3 className=\"font-bold text-primary-foreground\">{item.titulo}</h3>\n                      <p className=\"text-sm text-primary-foreground/70 capitalize\">{item.tipo}</p>\n                      <p className=\"text-xs text-primary-foreground/50\">{item.fecha}</p>\n                    </div>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-xl font-bold text-accent\">+{item.puntos}</p>\n                    <span className=\"text-xs px-2 py-1 rounded-full bg-accent/20 text-accent\">{item.estado}</span>\n                    {item.co2_ahorrado && <p className=\"text-xs text-green-400 mt-1\">-{item.co2_ahorrado}kg CO₂</p>}\n                  </div>\n                </div>\n              </Card>\n            ))\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}